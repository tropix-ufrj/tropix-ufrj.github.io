<pre><code>  *******   *******  *******   *******    *    *     *
     *      *     *  *     *   *     *    *     *   *
     *      *     *  *     *   *     *    *      * *
     *      *******  *     *   *******    *       *
     *      *  *     *     *   *          *      * *
     *      *   *    *     *   *          *     *   *
     *      *    *   *******   *          *    *     *
















                TROPIX - Guia de INSTALAÇÃO


                       Versão 4.9.0




                           Guia
















                     Dezembro de 2008


                         CONTEÚDO





    Cap.  1 - Introdução ...........................  4

    Cap.  2 - Novidades das Versões ................  6

    Cap.  3 - Características ...................... 11

    Cap.  4 - Configuração do PC ................... 12

    Cap.  5 - Criação do CDROM ..................... 13

    Cap.  6 - Criação do disquete de BOOT .......... 14

    Cap.  7 - Algumas  Convenções/características do
              TROPIX ............................... 16

    Cap.  8 - Executando  o  TROPIX  diretamente  do
              CDROM ou disquete .................... 18

    Cap.  9 - Preparação dos disquetes/arquivos
              restantes ............................ 22

    Cap. 10 - Modos de instalação do TROPIX no disco
              rígido ............................... 23

    Cap. 11 - Instalação  do  TROPIX  em arquivos do
              MS-DOS/Windows ....................... 24

    Cap. 12 - Discos e partições ................... 26

    Cap. 13 - O editor de partições &quot;fdisk&quot; ........ 28

    Cap. 14 - Reduzindo  o  tamanho  de uma partição
              MS-DOS/Windows ....................... 32

    Cap. 15 - Instalação   do  TROPIX  em  partições
              próprias ............................. 35

    Cap. 16 - Configuração dos controladores USB.... 37

    Cap. 17 - E agora? ............................. 38

    Cap. 18 - Características e Utilitários originais
              do TROPIX ............................ 40

    Cap. 19 - Introdução    à    Interface   Gráfica
              X-Window ............................. 41

    Cap. 20 - Criação e instalação dos  disquetes/
              arquivos da Interface Gráfica ........ 42

    Cap. 21 - Configuração da interface Gráfica .... 43

    Cap. 22 - Utilização básica da interface Gráfica 45

    Cap. 23 - Obtenção e instalação do  código fonte
              do TROPIX ............................ 46

    Cap. 24 - Compilação  do  núcleo, bibliotecas  e
              utilitários do TROPIX ................ 47

    Cap. 25 - O uso do editor de textos &quot;vi&quot; ....... 48

    Cap. 26 - Uma  lista  dos principais comandos do
              TROPIX ............................... 49</code></pre>
<h1 id="capítulo-1">Capítulo 1</h1>
<h2 id="introdução">INTRODUÇÃO</h2>
<p>O TROPIX (pronuncia-se “trópix”) é um Sistema Operacional de 32 bits,multiusuário e multitarefa, de filosofia UNIX ®, desenvolvido no Núcleo de Computação Eletrônica da Universidade Federal do Rio de Janeiro (NCE/UFRJ).</p>
<p>O TROPIX foi inicialmente concebido durantes os anos de 1982 a 1986 (na época com o nome PLURIX) para o computador PEGASUS. Este computador foi construído também no NCE, e era baseado nos processadores MOTOROLA 68010/20. Desde seu início, o sistema foi concebido com multiprocessamento simétrico, funcionando em um PEGASUS que possuía 2 CPUs 68020.</p>
<p>O sistema foi transportado em 1987 para o computador ICARUS, baseado nestes mesmos processadores, e acrescentada parte do suporte para tempo real. Em 1994 foi iniciado o transporte para a linha INTEL de processadores (386, 486, Pentium), e desde 1996 o TROPIX já está operacional em PCs, sendo utilizado em diversos computadores.</p>
<p>Nesta versão para PCs, ainda não está concluída a deteção de placas-mãe com mais de uma CPU, o que é necessário para o multiprocessamento.</p>
<p>Em relação ao tempo real, foi recentemente concluída uma tese de mestrado na qual foi desenvolvida uma versão do núcleo do TROPIX para tempo real.</p>
<p>O TROPIX tem diversas utilidades, tais como o estudo/aprendizado/utilização de um sistema operacional de filosofia UNIX, o desenvolvimento de programas (“software”) e a implementação de servidores para a INTERNET. Além disto, é ideal para a utilização em cursos de sistemas operacionais, pois contém primitivas para processos “leves” (“threads”), memória compartilhada, semáforos a nível de usuário, dentre outros.</p>
<p>Este texto (que você está lendo) contém informações introdutórias sobre a distribuição e instalação do sistema TROPIX. Durante a instalação, ele pode ser consultado/impresso no seu PC (veja o final do capítulo 8). Além disto, contém as informações para a instalação da Interface Gráfica X-Window (capítulos 19 a 22), e as informações para a instalação/compilação do código fonte do TROPIX (capítulos 23 e 24).</p>
<p>O sistema operacional TROPIX é um “software” livre, e você é bem-vindo para redistribuí-lo sob certas condições; para detalhes, tecle “man licença” (após a sua instalação).</p>
<p>Atualmente, o desenvolvimento e manutenção do TROPIX estão sendo feitos por Pedro Salenbauch e Oswaldo Vernet. Para maiores</p>
<p>informações, sugestões, comunicação de erros, ou em caso de quaisquer dúvidas sobre a sua instalação e utilização, use o endereço eletrônico “tropix@tropix.nce.ufrj.br”.</p>
<p>Visite periodicamente a página eletrônica do TROPIX, no endereço “http://www.tropix.nce.ufrj.br” para informar-se sobre novas versões do sistema.</p>
<p>A continuação deste trabalho é uma homenagem póstuma a Newton Faller, o grande idealizador dos projetos PEGASUS, PLURIX, TROPIX e de tantos outros.</p>
<h1 id="capítulo-2">Capítulo 2</h1>
<h2 id="novidades-das-versões">NOVIDADES DAS VERSÕES</h2>
<h3 id="novidades-desta-versão-4.9.0">Novidades desta versão “4.9.0”:</h3>
<ol type="1">
<li><p>Implementado o protocolo USB 2.0.</p></li>
<li><p>Suporta a discos SATA.</p></li>
<li><p>Nova versão da interface gráfica (baseada na versão 4.7.0 distribuída pelo Consórcio XFree86).</p></li>
</ol>
<p>Para acompanhar a evolução do TROPIX, incluímos as novidades das versões anteriores.</p>
<h3 id="novidades-da-versão-4.8.0">Novidades da versão “4.8.0”:</h3>
<ol type="1">
<li>Sistema de Arquivos NFS (Network File System, Versão 2), para a montagem de sistemas de arquivos remotos.</li>
</ol>
<h3 id="novidades-da-versão-4.7.0">Novidades da versão “4.7.0”:</h3>
<ol type="1">
<li><p>Distribuição do código objeto em CDROM.</p></li>
<li><p>Novo utilitário gráfico “xcpu”, que desenha o gráfico de uso da CPU.</p></li>
</ol>
<h3 id="novidades-da-versão-4.6.0">Novidades da versão “4.6.0”:</h3>
<ol type="1">
<li><p>Suporte a discos USB (simulados em memória, “pen drive”), com anexação/desanexação dinâmica.</p></li>
<li><p>Montagem (somente para leituras) do sistema de arquivos NTFS.</p></li>
<li><p>Montagem de imagens de sistemas de arquivos (em arquivos regulares).</p></li>
<li><p>Nova versão da interface gráfica (baseada na versão 4.4.0 distribuída pelo Consórcio XFree86).</p></li>
</ol>
<h3 id="novidades-da-versão-4.5.0">Novidades da versão “4.5.0”:</h3>
<ol type="1">
<li><p>Reconhecimento de “mouse” USB.</p></li>
<li><p>Novos utilitários gráficos: o gerenciador de arquivos “xfm”, o programa para acessar caixas postais remotas “xpop3” e o gerador de imagens fractais de Mandelbrot “xmandel”.</p></li>
<li><p>Extensão do núcleo para permitir o compartilhamento das interrupções (IRQ) entre dispositivos.</p></li>
<li><p>Acesso a sistemas de arquivos FAT-32 de mais de 4 GB.</p></li>
</ol>
<h4 id="novidades-da-versão-4.4.0">Novidades da versão “4.4.0”:</h4>
<ol type="1">
<li><p>Montagem de Sistemas de Arquivos EXT2 do Linux.</p></li>
<li><p>Suporte ao “mouse” PS/2.</p></li>
<li><p>Nova versão (XFree86 Version 4.3.0) do Sistema Gráfico X-Window, suportando os modelos mais recentes das placas gráficas ATI, TRIDENT e S3.</p></li>
<li><p>Novas funções da biblioteca “stdio” com áreas de 4 KB, para compatibilizá-la com o novo sistema de arquivos T1.</p></li>
<li><p>Funções aritméticas de 64 bits para os valores “long long” da linguagem “C”. Isto é importante para o acesso a arquivos com mais de 4 GB.</p></li>
<li><p>Acesso ao histórico da “sh” através das teclas de setas também em modo texto.</p></li>
<li><p>Novos comandos: O desfragmentador “xdefrag” (programa gráfico) permite melhorar a alocação dos blocos de sistemas de arquivos T1; o programa conversor “a2ps” converte um texto ISO para PostScript, para ser impresso em impressoras que aceitam esta linguagem.</p></li>
</ol>
<h3 id="novidades-da-versão-4.3.0">Novidades da versão “4.3.0”:</h3>
<ol type="1">
<li><p>O novo sistema de arquivos T1, com blocos de 4 KB e identificadores de até 255 caracteres, que tem um desempenho muito superior ao sistema de arquivos anterior (V7) de blocos de 512 bytes. A presente versão continua suportando o sistema de arquivos V7.</p></li>
<li><p>Criação do arquivo “/etc/fstab” para o melhor controle da montagem de dispositivos.</p></li>
<li><p>Nova interface para reconhecimento de dispositivos IDE/ATA/ATAPI.</p></li>
<li><p>Disquete de BOOT da distribuição contendo a imagem de um sistema de arquivos que é descompactada em um RAMD (a simulação de um disco na memória principal). Isto facilita a instalação do TROPIX.</p></li>
</ol>
<h3 id="novidades-da-versão-4.2.0">Novidades da versão “4.2.0”:</h3>
<ol type="1">
<li><p>Aumento do tamanho das áreas de entrada/saída do “cache” de dispositivos estruturadas de 512 para 4096 bytes. Com isto, possibilitamos a leitura/escrita de dispositivos que possuem blocos maiores do que 512 bytes (por exemplo o CDROM, cujo bloco é de 2 KB) além de aumentarmos a velocidade de processamento dos dispositivos já suportados.</p></li>
<li><p>Criação da camada abstrata de “nós-índice” para possibilitar a montagem de vários sistemas de arquivos.</p></li>
<li><p>Montagem de sistemas de arquivos FAT12/16/32.</p></li>
<li><p>Montagem de sistemas de arquivos de CDROM original, além das extensões “Rock Ridge” e “Joliet”.</p></li>
<li><p>Implementação dos elos simbólicos.</p></li>
</ol>
<h3 id="novidades-da-versão-4.1.0">Novidades da versão “4.1.0”:</h3>
<ol type="1">
<li><p>Novo “driver” para controladores SCSI da Adaptec: Agora suportando os novos controladores 29160, para 160 MB/s.</p></li>
<li><p>Adicionados os “chip”s da VIA e INTEL para o uso de DMA com o acesso a discos IDE.</p></li>
<li><p>Estendido o sistema de compilação da linguagem “C” para aceitar identificadores sem limitação de tamanho.</p></li>
<li><p>Introduzidas as funções da biblioteca “C” para leitura de diretórios em um formato independente do sistema de arquivos: “opendir”, “readdir”, …</p></li>
<li><p>O “boot” do TROPIX foi estendido, e já aceita os discos Iomega ZIP (100 MB) para carregar o sistema, em todas as suas etapas.</p></li>
</ol>
<h3 id="novidades-da-versão-4.0.0">Novidades da versão “4.0.0”:</h3>
<ol type="1">
<li><p>Melhorado o reconhecimento e a avaliação da velocidade do processador do computador durante o estágio 2 da carga do sistema (“boot2”).</p></li>
<li><p>Suporte para discos IDE com mais de 8 GB.</p></li>
<li><p>Reconhecimento de dispositivos PnP (“Plug and Play”).</p></li>
<li><p>Utilização de DMA para o acesso a discos IDE (no momento somente para o “chip” “Acer Aladdin”).</p></li>
<li><p>Comando “mail” inteiramente reescrito, agora podendo receber e enviar anexos.</p></li>
</ol>
<h3 id="novidades-da-versão-3.2.3">Novidades da versão “3.2.3”:</h3>
<p>Esta versão “continha como novidade principal as bibliotecas compartilhadas (semelhantes às DLLs do Windows). Todas as bibliotecas das versões antigas (”libc“,”libm“,”libcurses" e “libxti”) estão agora reunidas em apenas uma biblioteca compartilhada “/lib/libt.o”.</p>
<p>O mesmo ocorre também com as bibliotecas da interface gráfica X-Window: todas elas estão agora integradas nas duas bibliotecas compartilhadas “/usr/xwin/lib/libx.o” e “/usr/xwin/lib/liby.o”.</p>
<p>Com a utilização das bibliotecas compartilhadas, o tamanho dos módulos executáveis diminuiu drasticamente. Com isto reduziu-se simultaneamente o tempo de carga e a quantidade de espaço ocupados (tanto no disco como na memória principal). Como exemplo, um utilitário típico, o “cp” que ocupava 13704 bytes, passou a ocupar apenas 4032, isto é, caiu a menos do terço do tamanho. No caso dos utilitários gráficos, esta redução é muito maior; como exemplo citamos o programa “xedit”, que passou de 612 KB para menos de 4KB!</p>
<p>Esta versão inclui também alguns programas novos, entre os quais:</p>
<ol type="1">
<li><p>“cdplay”: toca CDs de áudio em unidades IDE/ATAPI e SCSI.</p></li>
<li><p>“cdtowave”: extrai faixas de áudio de CDs em unidades IDE/ATAPI e SCSI.</p></li>
<li><p>“sbvol”: controla o volume (mestre) das placas SB-16.</p></li>
<li><p>“mkshlib” e “ldshlib”: cria e carrega as bibliotecas compartilhadas.</p></li>
<li><p>“nohup”: executa comandos imunes ao sinal SIGHUP.</p></li>
<li><p>“paste”: une linhas de vários arquivos.</p></li>
<li><p>“fdc”: pequeno calculador de mesa para números de ponto flutuante.</p></li>
<li><p>“xcoremap”: programa gráfico para desenhar um mapa de alocação da memória principal do computador.</p></li>
<li><p>“xedit”: programa gráfico para editar textos (similar ao “notepad” do Windows).</p></li>
<li><p>“xpaint”: agora já aceita o formato JPEG.</p>
<p>Outros modificações/aprimoramentos:</p></li>
<li><p>“Drivers” para dispositivos IDE-ATAPI: Estes “drivers” irão permitir ao TROPIX acessar dispositivos IDE-ATAPI, tais como CD-ROMs e acionadores de discos ZIP internos. No entanto, os sistemas de arquivos dos CD-ROMs ainda não estão sendo reconhecidos.</p></li>
<li><p>“Driver” para o controlador “Realtek RTL 8129/8139 Fast Ethernet” (10/100 Mbs).</p></li>
<li><p>A partição de SWAP não é mais necessária para a instalação, tanto em partições próprias, como em arquivos do MS-DOS/Windows.</p></li>
<li><p>Já é reconhecido o Fax-modem U.S. Robotics 56K PCI.</p></li>
<li><p>Inauguração da distribuição do código fonte das bibliotecas e utilitários do TROPIX.</p></li>
<li><p>O servidor WWW do TROPIX já permite a retomada das transferências a partir do ponto em que foram interrompidas.</p></li>
</ol>
<h3 id="novidades-da-versão-3.2.1">Novidades da versão “3.2.1”:</h3>
<p>Inclui a primeira distribuição do código fonte do núcleo do sistema, recomendando-o mais ainda para um curso de sistemas operacionais.</p>
<h3 id="novidades-da-versão-3.2.0">Novidades da versão “3.2.0”:</h3>
<p>Continha como novidade principal o suporte (parcial) para a placa de som “Sound Blaster”.</p>
<h3 id="novidades-da-versão-3.1.8">Novidades da versão “3.1.8”:</h3>
<p>Continha como novidades a Interface Gráfica X-Window e o suporte para sistemas de arquivos MS-DOS/Windows com FAT32.</p>
<p># Capítulo 3<br />
## CARACTERÍSTICAS</p>
<p>A distribuição do TROPIX é gratuita, e ele pode ser instalado através de um CDROM ou de disquetes.</p>
<ol type="1">
<li><p>O CDROM é distribuído através de uma imagem, e contém o TROPIX objeto completo (incluindo o Sistema Gráfico X-Window). Esta imagem deverá ser usada para gravar um CDROM através de um programa apropriado: veja o capítulo 5.</p></li>
<li><p>A distribuição através de disquetes consiste da parte básica com 2 disquetes de 3½" e o Sistema Gráfico X-Window em 2 disquetes adicionais: veja os capítulos 19 a 22.</p></li>
</ol>
<p>A instalação em PCs pode ser realizada de dois modos: em partições próprias ou em arquivos de uma partição FAT16 ou FAT32 do MS-DOS/Windows (neste caso sem a necessidade de alterar as partições dos discos). É incluído um gerenciador de carga de sistemas operacionais (“boot0”), para a convivência amigável com outros sistemas operacionais.</p>
<p>Atualmente o TROPIX possui os comandos básicos do UNIX (além de mais alguns comandos próprios), um sistema de desenvolvimento para a linguagem ANSI “C”, o suporte para a rede de computadores INTERNET com protocolos TCP/IP, SLIP, PPP (para linha discada) e os clientes/servidores “telnet”, “rlogin”, “ftp”, “mail”, “pop3” e outros.</p>
<p>Todo o TROPIX é baseado no código de caracteres ISO-8859-1 (Latim-1, o mesmo do Windows 95/98/NT/2000/XP), tendo toda a acentuação disponível em todos os modos (texto, gráfico) e comandos. Além disto, todos os manuais podem ser consultados na tela (“on-line”), e são em português.</p>
<p>Os sistemas de arquivos MS-DOS/Windows FAT-12/16/32/NTFS (tanto em disquetes como em partições dos discos rígidos) podem ser montados (este último somente para leituras).</p>
<p>Para a montagem de sistemas de arquivos remotos temos disponível o protocolo NFS, versão 2.</p>
<p>Também CD-ROMs podem ser montados em todas as suas variantes (ISO-9660, Rock-Ridge e Joliet).</p>
<h1 id="capítulo-4">Capítulo 4</h1>
<h2 id="configuração-do-pc">CONFIGURAÇÃO DO PC</h2>
<p>O PC deve possuir um processador Intel 486/PENTIUM ou equivalente. O mínimo razoável de memória principal é 8 MB. Com 4 MB é possível utilizar o sistema, mas pode haver dificuldades em simultaneamente usar a rede INTERNET e compilar programas. Para a Interface Gráfica X-Window são necessários pelo menos 16 MB.</p>
<p>São aceitos os controladores USB, mas apenas dos padrões UHCI e OHCI.</p>
<p>São suportados disquetes de 3½" e 5¼" e discos rígidos IDE/EIDE. Também são suportados discos rígidos SCSI conectados através dos controladores SCSI Adaptec 1542 (ISA) e 2940/29160 (PCI).</p>
<p>A partir da versão 4.9.0 são suportados dispositivos USB com protocolo 1.1 e 2.0 com anexação/desanexação dinâmica.</p>
<p>Os disquetes Iomega ZIP (100 MB) também são suportados nas versões de porta paralela, IDE/ATAPI e SCSI (desde que conectados a um dos controladores SCSI indicados acima).</p>
<p>Para a rede INTERNET, são suportados os controladores “ethernet” Novell (NE1000, NE2000 ISA/PCI), 3Com 3c503 e Realtek RTL 8129/8139 Fast Ethernet (10/100 Mbs), além de linhas seriais com protocolos SLIP ou PPP.</p>
<p>São suportadas também as portas paralelas para o uso de impressoras.</p>
<p>São aceitos os Fax-modems ISA e o Fax-modem U.S. Robotics 56K PCI.</p>
<p>A partir da versão 3.2.0 é também suportada a saída de som digital PCM através das placas de som “Sound Blaster 16” (ou sucessoras). Com isto, é possível tocar arquivos de som "*.wav" no TROPIX.</p>
<p>Já são suportados “mouse”s USB.</p>
<p>Como já foi mencionado, há dois modos de instalação do TROPIX nos discos rígidos do PC (veja o capítulo 10). Em qualquer um destes modos é necessário alocar um certo espaço dos discos rígidos (tipicamente 128 MB).</p>
<h1 id="capítulo-5">Capítulo 5</h1>
<h2 id="criação-do-cdrom">CRIAÇÃO DO CDROM</h2>
<p>Tendo obtido a coleção “cdrom.tgz” da distribuição do CDROM do TROPIX, é necessário gravá-lo.</p>
<ol type="1">
<li><p>Se você utiliza um sistema UNIX, deve descomprimir “cdrom.tgz” através de “gunzip” (gerando uma coleção “tar”), e em seguida usar o comando “tar” para obter os arquivos:</p>
<pre><code>      install.txt
      tropix.iso</code></pre>
<p>O arquivo “install.txt” é o guia de instalação (que você está lendo) e o arquivo “tropix.iso” é a imagem do CDROM.</p>
<p>O CDROM deve ser gravado através de um utilitário adequado (tal como o “cdrecorder”).</p></li>
<li><p>Se você utiliza WinXP/Win2000/WinNT/Win98/Win95/Win3.x, deve descomprimir a coleção “cdrom.tgz” através de “Winzip”, obtendo os arquivos:</p>
<pre><code>      install.txt
      tropix.iso</code></pre>
<p>O arquivo “install.txt” é o guia de instalação (que você está lendo) e o arquivo “tropix.iso” é a imagem do CDROM.</p>
<p>O CDROM deve ser gravado através de um utilitário adequado (tal como o “Easy CD Creator” ou o “Nero”).</p></li>
</ol>
<h1 id="capítulo-6">Capítulo 6</h1>
<h2 id="criação-do-disquete-de-boot">CRIAÇÃO DO DISQUETE DE “BOOT”</h2>
<p>Tendo obtido a coleção “tropix.tgz” da distribuição do TROPIX básico, é necessário (pelo menos) criar o disquete de 3½" chamado de BOOT.</p>
<ol type="1">
<li><p>Se você utiliza um sistema UNIX, deve descomprimir “tropix.tgz” através de “gunzip” (gerando uma coleção “tar”), e em seguida usar o comando “tar” para obter os arquivos:</p>
<pre><code>      install.txt
      fdimage.exe
      boot.dsk
      gar1.dsk</code></pre>
<p>O arquivo “install.txt” é o guia de instalação (que você está lendo), o arquivo “fdimage.exe” é um utilitário de cópia para o MS-DOS/Windows (que neste caso não será usado), e os arquivos restantes são os conteúdos dos 2 disquetes chamados de BOOT e GAR1.</p>
<p>O disquete de BOOT pode ser criado através de um comando do tipo:</p>
<pre><code>      cat boot.dsk &gt;/dev/fd0</code></pre>
<p>(o nome exato do dispositivo do disquete depende do sistema sendo usado).</p>
<p>Pode também ser usado o comando “dd” na forma:</p>
<pre><code>      dd if=boot.dsk of=/dev/fd0</code></pre></li>
<li><p>Se você utiliza WinXP/Win2000/WinNT/Win98/Win95/Win3.x, deve descomprimir a coleção “tropix.tgz” através de “Winzip”, obtendo os arquivos:</p>
<pre><code>      install.txt
      fdimage.exe
      boot.dsk
      gar1.dsk</code></pre>
<p>O arquivo “install.txt” é o guia de instalação (que você está lendo), o programa “fdimage.exe” é um utilitário de cópia e os arquivos restantes são os conteúdos dos 2 disquetes. O disquete de BOOT deve ser criado através de um comando do tipo</p>
<pre><code>      fdimage.exe -v boot.dsk A:</code></pre>
<p>No caso de WinXP/Win2000/WinNT, use a janela de comandos;</p>
<p>para Win98/Win95/Win3.x use o modo DOS; neste caso não recomendamos usar a janela de comandos DOS, pois às vezes a escrita é realizada incorretamente.</p></li>
</ol>
<p>Utilize um disquete novo, de boa qualidade. Muitos dos erros relatados são ocasionados por disquetes defeituosos.</p>
<p>Após a geração do disquete, recomendamos protegê-lo contra escritas.</p>
<h1 id="capítulo-7">Capítulo 7</h1>
<h2 id="algumas-convençõescaracterísticas-do-tropix">ALGUMAS CONVENÇÕES/CARACTERÍSTICAS DO TROPIX</h2>
<p>Conceitualmente, o sistema operacional TROPIX é semelhante aos sistemas tipo UNIX, embora existam algumas diferenças. Para descrever de forma não ambígua o procedimento de instalação e uso do TROPIX nos PCs, usaremos as convenções descritas abaixo. Repare bem nestas convenções, pois elas serão usadas no TROPIX como um todo, incluindo o sistema depois de instalado.</p>
<p>Teclar <enter> significa pressionar a tecla que tem este nome; teclar <sp> (espaço em branco) significa teclar a barra de espaço.</p>
<p>Teclar &lt;^D&gt; significa comprimir simultaneamente as teclas “ctl” e “D”. Ao fazer isto, devemos comprimir inicialmente a tecla “ctl” (segurando-a comprimida) e em seguida comprimir a tecla “D”. Analogamente, teclar &lt;^A&gt;, &lt;^B&gt;, … significa comprimir a teclas “ctl” juntamente com “A”, “B”, … Em alguns teclados, podemos ter “ctrl” ao invés de “ctl”.</p>
<p>Teclar <ctl-alt-del> significa comprimir simultaneamente as três teclas indicadas; teclar <reset> significa comprimir o botão de “reset” do PC que, em geral, fica no gabinete do PC (e não no teclado).</p>
<p>Teclar “-fd0 tropix” significa teclar em sequência as teclas “-”, “f”, “d”, “0”, <sp>, “t”, “r”, “o”, “p”, “i”, “x” e <enter>. Quando especificamos uma cadeia de caracteres para ser teclada (como a dada acima) assumimos implicitamente que seja teclado um <enter> ao final da cadeia (a não ser que seja explicitamente indicado o contrário).</p>
<p>Devemos nos lembrar que no TROPIX, assim como em todos os sistemas operacionais similares ao UNIX, letras maiúsculas são caracteres DIFERENTES de letras minúsculas. No exemplo acima, portanto, não devemos comprimir a tecla <shift> pois as letras a serem geradas são todas minúsculas.</p>
<p>Alguns dos comandos do TROPIX podem pedir uma informação/confirmação de ação. Este pedido é identificado por um “prompt” que pode ser um caracter ou uma cadeia de caracteres que o sistema escreve na tela.</p>
<p>No TROPIX, alguns do “prompt”s contêm uma cadeia de caracteres entre parênteses antes de um “:”. Isto significa que teclar aquela cadeia ou simplesmente teclar <enter> terá o mesmo efeito. Essa cadeia de caracteres é chamada de “default”, isto é, aquilo que será interpretado pela falta de uma cadeia de caracteres explicitamente teclada.</p>
<p>Assim, para a pergunta</p>
<pre><code> Carrega (fd0, tropix)? (s):</code></pre>
<p>é equivalente teclar “s” seguido de <enter> ou simplesmente <enter>, o que significa “sim”. Se desejarmos responder “não”, temos de teclar “n” seguido de <enter>.</p>
<p>Em alguns comandos, uma resposta com letra maiúscula (“S” ou “N”) faz com que esta e todas as perguntas subseqüentes sejam respondidas automaticamente (afirmativamente para “S” e negativamente para “N”). O manual de cada comando (veja abaixo) informa se ele segue esta convenção.</p>
<p>No TROPIX, usualmente, o sistema pára de escrever na tela ao completar uma tela (24 linhas). Isto é conveniente, pois o usuário tem tempo de ler o texto sem que um novo texto substitua o texto atual que (talvez) ainda não tenha sido lido. Para continuar a escrita do texto basta teclar &lt;^Q&gt;. Além disto, uma saída na tela pode ser parada a qualquer momento, teclando &lt;^S&gt;. Isto pode ser alterado atráves do comando “stty” (ver adiante).</p>
<p>Ao entrar no modo “multiusuário” (veja abaixo) o TROPIX oferece 8 telas virtuais independentes. O chaveamento entre as telas virtuais é feito teclando &lt;^S&gt; (para parar a saída na tela virtual corrente), seguido do número da tela virtual para a qual desejamos ir (1 a 8), e finalmente, &lt;^Q&gt; (para ativarmos a saída na nova tela virtual). Repare que o número da tela virtual corrente é mostrada no centro da última linha.</p>
<p>Com algumas combinações de teclas, usadas seqüencialmente, podemos gerar caracteres especiais. Assim, teclando-se “~a” obtemos “ã” e com “,c” obtemos “ç”. Com este método, podemos obter quase todas as vogais acentuadas das linguas ocidentais. Se não desejarmos esta composição, basta teclar “" entre os caracteres. Assim, por exemplo, se teclarmos”~\a" obteremos “~a”.</p>
<h1 id="capítulo-8">Capítulo 8</h1>
<h2 id="executando-o-tropix-diretamente-do-cdrom-ou-disquete">EXECUTANDO O TROPIX DIRETAMENTE DO CDROM OU DISQUETE</h2>
<p>Tanto o CDROM do TROPIX (obtido no capítulo 5), como o disquete de BOOT (obtido no capítulo 6), contém a imagem comprimida de um sistema de arquivos TROPIX autônomo. Ambos podem ser executados inserindo-os na unidade correspondente e teclando <ctl-alt-del> ou <reset> (esta operação, de carga do sistema operacional, chamamos de “boot”).</p>
<p>Não esqueça de verificar se a ordem dos vários dispositivos na seqüência de “boot” da BIOS do seu computador é a desejada.</p>
<p>Isto é útil para:</p>
<ol type="1">
<li><p>Testar a compatibilidade do TROPIX com o seu computador. Se houver alguma incompatibilidade, comunique-nos (através do endereço eletrônico do capítulo 1).</p></li>
<li><p>Executar o TROPIX experimentalmente, para conhecer o sistema sem alterar os discos rígidos do seu computador.</p></li>
<li><p>Ler este guia de instalação na tela do computador e/ou imprimi-lo na sua impressora (veja o final deste capítulo).</p></li>
<li><p>Instalar o TROPIX no disco rígido do seu computador. Há dois modos de instalação: veja o capítulo 10.</p></li>
<li><p>Consertar o TROPIX residente no disco rígido, caso apresente problemas.</p></li>
</ol>
<p>Após o “reset”, o “boot1” (o primeiro estágio da operação de “boot”) será lido do CDROM ou disquete. É escrita a mensagem:</p>
<pre><code> TROPIX CD boot1, Versao: 4.9.0, de 17.06.06

 &gt;</code></pre>
<p>Teclando <enter>, será lido o “boot2” (o segundo estágio) do CDROM ou disquete; após a leitura, teremos a mensagem</p>
<pre><code> TROPIX boot2, Versão: 4.9.0, de 17.11.08

 Copyright © 1988-2008 NCE/UFRJ

 Processador PENTIUM ................................
 ....................................................
 ........ (e outros dados do computador) ............
 ....................................................



 boot&gt;</code></pre>
<p>Neste ponto, o “boot2” está aguardando um comando. Ele é um programa versátil, que pode (entre outros) carregar e executar um programa, editar/imprimir a tabela de partições e listar o conteúdo da memória ou dispositivo. Se teclarmos “?”, ele imprime a sua lista de comandos.</p>
<p>No nosso caso, devemos teclar “-i”, para descomprimir a imagem do sistema de arquivos da RAIZ do CDROM ou disquete para uma área no final da memória principal. Esta área será então usado como um RAMD, ou seja, a simulação de um disco na memória.</p>
<p>Após a descompressão, é escrita a mensagem</p>
<pre><code> TROPIX INTEL x86 - Versão 4.9.0 de 28.11.08 ...

 Copyright © 1988-2008 NCE/UFRJ

 O sistema operacional TROPIX é distribuído ABSOLUTAMENTE
 SEM GARANTIA. Este é um &quot;software&quot; livre, e você é bem-vindo
 para redistribuí-lo sob certas condições; para detalhes,
 tecle &quot;man licença&quot;.

 Deseja modificar parâmetros? (n):</code></pre>
<p>Teclando <enter> mais uma vez, surje a mensagem</p>
<pre><code> TROPIX (meu_computador) mono [5]: </code></pre>
<p>Uma vez atingido este ponto, o sistema operacional TROPIX já assumiu o controle em seu modo “monousuário”, havendo apenas uma tela virtual ativa (a que você está usando).</p>
<p>Tecle &lt;^D&gt;, para entrar no modo “multiusuário”, no qual várias telas virtuais estarão disponíveis. Serão escritas diversas informações na tela, até aparecer uma linha contendo:</p>
<pre><code> LOGIN:</code></pre>
<p>Tecle “root” e será impressa a linha:</p>
<pre><code> Senha:</code></pre>
<p>Tecle então “tropix” (que não será ecoado na tela) e finalmente será impressa a linha:</p>
<pre><code> root@meu_computador:[/home/root]# </code></pre>
<p>Pronto! Uma parte crítica foi vencida. O TROPIX já está rodando em modo multiusuário em seu computador.</p>
<p>Durante a carga, o núcleo do TROPIX escreve a mensagem</p>
<pre><code>    Deseja modificar parâmetros? (n):</code></pre>
<p>após a qual normalmente teclamos <enter>. Com isto, aceitamos os valores “default” dos parâmetros, que em geral são os desejados. Podemos, no entanto modificar vários parâmetros, sendo o mais comum o “rootdev”, isto é, o dispositivo raiz do sistema. Este parâmetro contém o valor NODEV (isto é, indefinido), e na inicialização do núcleo, este procura uma raiz adequada. A ordem de busca é:</p>
<ol type="1">
<li><p>partições TROPIX dos discos rígidos (por exemplo “hda2a”);</p></li>
<li><p>dispositivos simulando discos a partir de arquivos MS-DOS/Windows (por exemplo “md1”);</p></li>
<li><p>CDROMs (por exemplo “hdb” ou “sdb”).</p></li>
<li><p>disquetes (por exemplo “fd0”).</p></li>
</ol>
<p>Podemos alterar o valor “default”, atribuindo uma <raiz  desejada> através de</p>
<pre><code>    rootdev=&lt;raiz desejada&gt;</code></pre>
<p>e em seguida teclando &lt;^D&gt;. Isto é útil, por exemplo, quando já temos uma partição ROOT em um disco rígido ou arquivo MS-DOS/Windows e desejamos iniciar uma nova instalação a partir do CDROM ou disquete.</p>
<p>Repare que o que foi teclado após “LOGIN” é o nome da conta (“root” no caso), e o que o que foi teclado após “Senha” é a sua respectiva senha (“tropix” no caso). Isto significa que estamos utilizando a conta “root”, que é a conta do superusuário, com poderes (quase) ilimitados. Isto é necessário durante a instalação, mas não é recomendável para o uso normal.</p>
<p>Para consultar este guia de distribuição/instalação na tela do computador, tecle “man install”. Para avançar/retroceder pelas várias páginas do guia, use os comandos &lt;^D&gt;, &lt;^U&gt;. Para ler o conteúdo, use “2p”; para ir diretamente para a página <n> (obtida através do conteúdo), use “<n>p”. Para encerrar a execução de “man”, tecle “q”.</p>
<p>Para imprimir este guia, use o comando</p>
<pre><code> cat /usr/man/ref/install &gt;/dev/lp</code></pre>
<p>(isto só é possível se o seu PC tiver a impressora na porta/IRQ padrão). Lembre-se de que o guia utiliza o código ISO-8859-1 (Latim-1) de caracteres; se a sua impressora não aceita este código de caracteres, use o comando</p>
<pre><code> stty ascii 2&gt;/dev/lp</code></pre>
<p>antes do “cat”, para retirar os acentos dos caracteres.</p>
<p>Se a sua impressora for uma HP, aceitando a linguagem PCL, você pode usar o comando “hpprint”.</p>
<p>Uma outra possibilidade é a impressão deste guia através do MS-DOS/Windows, usando a seqüência de comandos:</p>
<pre><code> mount /dev/hda1 /mnt
 cp /usr/man/ref/install /mnt
 umount /dev/hda1</code></pre>
<p>onde “/dev/hda1” deve ser substituído por uma partição DOS/Windows FAT 16/32 adequada (em geral pode ser usado o próprio “/dev/hda1”, pois provavelmente corresponde à unidade “C:”). Para obter os nomes das partições correspondentes às partições MS-DOS/Windows, use o comando “prdisktb”.</p>
<p>Após estes comandos, imprima o arquivo “install” através do MS-DOS/Windows; é melhor utilizar o Windows, em virtude do código de caracteres usado (ISO-8859-1 (Latim-1)).</p>
<h1 id="capítulo-9">Capítulo 9</h1>
<h2 id="preparação-dos-disquetesarquivos-restantes">PREPARAÇÃO DOS DISQUETES/ARQUIVOS RESTANTES</h2>
<p>Este capítulo contém informações apenas para a instalação através de disquetes. Se você está instalando através de um CDROM, pode pulá-lo.</p>
<p>Repare que a coleção “tropix.tgz” contém a imagem de 2 disquetes, BOOT e GAR1. O disquete de BOOT já foi criado no capítulo 6.</p>
<p>Se você possui uma partição DOS/Windows FAT16/32 ou NTFS em seu computador, a criação do disquete GAR1 pode ser dispensada. A idéia consiste em copiar a imagem para um diretório “\TROPIX” da partição DOS/Windows.</p>
<ol type="1">
<li><p>Se você utiliza um sistema UNIX, deve utilizar comandos do tipo: mount /dev/hda1 /mnt mkdir /mnt/TROPIX cp gar1.dsk /mnt/TROPIX umount /dev/hda1</p>
<p>onde “/dev/hda1” pode ser substituído por uma outra partição DOS/Windows desejada.</p>
<p>Se a sua partição é NTFS, informe-se se o seu sistema UNIX suporta a escrita nestes sistemas de arquivos; muitos sistemas UNIX (inclusive o LINUX) suportam em geral apenas a leitura).</p></li>
<li><p>Se você utiliza WinXP/Win2000/WinNT/Win98/Win95/Win3.x, deve utilizar o “Windows Explorer” para criar o diretório “C:\TROPIX” e em seguida copiar o arquivo “gar1.dsk” para o diretório criado. Ao invés de “C:”, pode ser usada uma outra partição desejada.</p></li>
</ol>
<p>Se você NÃO possui uma partição DOS/Windows FAT16/32 ou NTFS em seu computador, ou está querendo instalar o TROPIX em outro computador, o disquete GAR1 terá de ser criado.</p>
<p>Isto deverá ser feito do modo já visto no capítulo 6, naturalmente susbtituindo-se “boot.dsk” por “gar1.dsk”.</p>
<p>Utilize disquetes novos, de boa qualidade. Muitos dos erros relatados são ocasionados por disquetes defeituosos.</p>
<p>Após a criação, recomendamos proteger o disquete contra escritas.</p>
<h1 id="capítulo-10">Capítulo 10</h1>
<h2 id="modos-de-instalação-do-tropix-no-disco-rígido">MODOS DE INSTALAÇÃO DO TROPIX NO DISCO RÍGIDO</h2>
<p>Há dois modos de instalar o TROPIX no disco rígido:</p>
<ol type="1">
<li><p>Em particões próprias do TROPIX. Este modo oferece o melhor desempenho, mas a instalação exige um certo cuidado. Opcionalmente pode ser instalado um gerenciador de “boot”, para permitir a escolha do sistema operacional a carregar. Siga a seqüência de capítulos 12, 13, 14, 15, 16 e 17.</p></li>
<li><p>Em arquivos do MS-DOS/Windows. Este modo não oferece um desempenho tão bom e o “boot” do TROPIX terá de ser sempre através de CDROM ou disquete, mas a instalação é mais simples. Veja os capítulos 11, 16 e 17.</p></li>
</ol>
<p>Sugerimos que você leia este guia até o final, antes de iniciar a instalação; assim você terá uma visão geral melhor e poderá avaliar adequadamente as diversas opções.</p>
<p>Os procedimentos para a instalação do TROPIX aqui descritos foram feitos para que a instalação se processe sem contratempos. No entanto, é possível que (por descuido do usuário) haja a perda de arquivos existentes no computador e/ou o sistema operacional original (por exemplo MS-DOS/Windows) não possa mais ser executado. Isto pode ocorrer principalmente em virtude do uso incorreto do editor de partições “fdisk” (capítulo 13).</p>
<p>Mesmo durante o uso normal do sistema (após uma instalação correta), é possível remover acidentalmente arquivos do MS-DOS/Windows durante o uso com partições FAT montadas, ou usando o utilitário “dosmp”.</p>
<p>Embora tenhamos testado o funcionamento do sistema, acreditando que ele não contenha nenhum erro grave, sempre existe teoricamente a possibilidade de que, através de algum erro ainda desconhecido, seja afetado algum outro sistema operacional.</p>
<p>NÓS NÃO NOS RESPONSABILIZAMOS POR ESTES POSSÍVEIS ACIDENTES! VOCÊ ESTÁ INSTALANDO/UTILIZANDO O TROPIX SOB SUA PRÓPRIA RESPONSABILIDADE E RISCO!</p>
<h1 id="capítulo-11">Capítulo 11</h1>
<h2 id="instalação-do-tropix-em-arquivos-do-ms-doswindows">INSTALAÇÃO DO TROPIX EM ARQUIVOS DO MS-DOS/Windows</h2>
<p>Este modo não oferece um desempenho tão bom quanto a instalação do TROPIX em partições próprias; em compensação, a instalação é mais simples, pois não é necessário reorganizar as partições do disco. Este método só é possível com sistemas de arquivos FAT-16 ou FAT-32; ainda NÃO é possível com NTFS.</p>
<p>A idéia consiste em utilizar uma partição já existente do MS-DOS/Windows e nela criar o diretório “\TROPIX” contendo 2 arquivos: “ROOT” e “HOME”. Estes arquivos irão conter os sistemas de arquivos TROPIX e a carga do sistema será feita através de CDROM ou disquete.</p>
<p>As etapas da instalação são as seguintes:</p>
<ol type="1">
<li><p>Inicialmente é interessante verificar a integridade da partição MS-DOS/Windows escolhida. Para isto use os utilitários CHKDSK ou SCANDISK (do MS-DOS ou do Windows).</p>
<p>Uma outra opção é usar o NDD (Norton Disk Doctor) dos “NORTON Utilities”. Repare o tamanho do espaço livre disponível da partição escolhida: para uma instalação normal são necessários 128 MB.</p></li>
<li><p>Como segundo passo, recomendamos desfragmentar a partição escolhida. Isto significa compactar todos os arquivos MS-DOS/Windows no início da partição, de tal modo que fique apenas uma área livre ao seu final, onde serão criados os 2 arquivos do diretório “\TROPIX”. Isto pode ser feito pelo utilitário DEFRAG (do MS-DOS ou do Windows), ou o SPEED DISK dos “NORTON Utilities”.</p></li>
<li><p>Insira o CDROM ou disquete de BOOT do TROPIX e carregue o sistema (conforme o capítulo 8). Entre no modo multiusuário.</p></li>
<li><p>Vá para o diretório “/usr/etc/install” (use o comando “cd /usr/etc/install”). A instalação normal irá ocupar 128 MB da sua partição MS-DOS/Windows (64 MB para o ROOT, 64 MB para HOME), o que já é suficiente para a interface gráfica X-Window. Se você tem este espaço disponível e está satisfeito com ele, vá para a etapa 5.</p>
<p>Para mudar o tamanho da instalação, basta editar o arquivo “install.dos” (veja o capítulo 25, para uma introdução ao uso do editor de texto “vi”). Para alterar o tamanho de um arquivo, basta mudar o número após a respectiva linha que começa por “mkfile”.</p></li>
<li><p>Inicie a instalação, teclando o comando “install.dos”.</p>
<p>Repare que com “C:” estamos nos referindo à primeira partição regular do primeiro disco; idem com “D:” para o segundo disco.</p>
<p>Esta etapa cria os 2 arquivos na partição MS-DOS/Windows escolhida, gera sistemas de arquivos TROPIX e copia os arquivos do TROPIX para o disco rígido. Durante a instalação (se você está instalando a partir de disquetes), será necessário um disquete adicional (cujo conteúdo será perdido) para ser usado para a carga do TROPIX. Siga as instruções.</p>
<p>Se você deseja conservar uma versão antiga do sistema de arquivos HOME, NÃO apague o arquivo MS-DOS/Windows HOME (desconsidere a mensagem “O arquivo”home" já existe“) e responda afirmativamente à pergunta”Deseja conservar a versão antiga de HOME?".</p></li>
<li><p>Parabéns! O TROPIX já está instalado e operacional em seu disco rígido.</p>
<p>Sempre que quiser executar o TROPIX, basta recarregar o sistema (teclando <ctl-alt-del> ou <reset>) com o CDROM ou o disquete DOS inserido. No caso do CDROM, é necessário modificar a raiz do sistema para “md1” durante a carga do núcleo (isto é, tecle “rootdev=md1”).</p>
<p>Se o CDROM e o disquete não estiverem inseridos, será carregado o sistema operacional normal (por exemplo MS-DOS/Windows). Para sair do TROPIX, use o comando “shutdown”.</p></li>
<li><p>Para desinstalar o TROPIX da sua partição MS-DOS/Windows, basta remover o diretório “\TROPIX” (juntamente com os seus 2 arquivos).</p></li>
</ol>
<p>Para facilitar a instalação futura de uma nova versão do TROPIX, recomendamos colocar seus arquivos particulares apenas no seu diretório “home” (nome de arquivos começando por “/home/…”).</p>
<h1 id="capítulo-12">Capítulo 12</h1>
<h2 id="discos-e-partições">DISCOS E PARTIÇÕES</h2>
<p>Para instalar o TROPIX em partições próprias (que possibilita o melhor desempenho), é necessário possuir uma noção básica de como são organizados os discos rígidos no PC.</p>
<p>Cada disco é dividido em uma ou mais seções denominadas “partições”. Cada uma destas partições é criada para ser usada por um sistema operacional (em certos casos algumas das partições podem ser compartilhadas por dois ou mais sistemas operacionais).</p>
<p>Podemos ter até 4 partições “regulares” (ou “primárias”) em cada disco. Se este número não for suficiente, podemos definir uma das partições como sendo do tipo “estendida”, que pode conter várias outras (sub-)partições chamadas de partições “lógicas”.</p>
<p>Os usuários dos MS-DOS/Windows certamente já tiveram contato com partições, pois nestes sistemas cada partição recebe uma letra, começando de “C”. Assim, temos as partições “C:”, “D:”, “E:”, …</p>
<p>A nomenclatura usada no TROPIX é bem distinta das letras indicadas acima. Vamos considerar um computador com apenas um disco IDE. As quatro partições são denominadas de “hda1”, “hda2”, “hda3” e “hda4”. Se uma delas for “estendida”, por exemplo “hda3”, ela conterá as (sub-)partições “lógicas” “hda3a”, “hda3b”, … Além disto, temos “hda” para representar o disco como um todo.</p>
<p>Se o computador tiver mais de um disco IDE, o segundo será o “hdb…” ao invés de “hda…” (bastando trocar o “a” por “b” no exemplo acima). Se o computador tiver discos SCSI, os nomes serão “sda…”, “sdb…”, … (bastando trocar o “h” por “s” no exemplo acima).</p>
<p>Como já foi dito, podemos ter apenas uma partição estendida. Por este motivo, no TROPIX foi criado um novo tipo de partição estendida (a partição estendida de tipo TROPIX), estruturalmente idêntica à original, mas com um outro código de identificação. O objetivo é possibilitar o agrupamento de todas as (sub-)partições TROPIX desejadas em apenas uma partição (estendida) isolada, mesmo que já exista uma partição estendida tradicional (que chamaremos de tipo DOS).</p>
<p>Ao escolher a distribuição das várias partições pelos seus (um ou mais) discos rígidos, deve ser levado em conta quantos discos estão presentes, quantas partições são necessárias/já estão alocadas, …</p>
<p>No exemplo do capítulo seguinte, criamos uma (nova) partição estendida (de tipo TROPIX) para conter todas as partições TROPIX. Isto é uma solução simples e elegante, pois somente necessitamos de uma partição vaga.</p>
<p>Naturalmente, podemos também criar uma partição regular para cada partição TROPIX desejada, ou ainda acrescentar novas partições lógicas TROPIX a uma partição estendida DOS já existente.</p>
<p>Para efeito de “boot”, o sistema de arquivos ROOT do TROPIX pode ser alocado em qualquer tipo de partição de qualquer disco.</p>
<p>Se houver espaço disponível em mais de um disco rígido, aconselhamos fortemente a distribuir as partições entre os vários discos.</p>
<h1 id="capítulo-13">Capítulo 13</h1>
<h2 id="o-editor-de-partições-fdisk">O EDITOR DE PARTIÇÕES “fdisk”</h2>
<p>Assim como os outros sistemas operacionais, o TROPIX também possui o seu editor de partições, que (como é usual) também é chamado de “fdisk”. No entanto, no TROPIX o “fdisk” está incorporado ao “boot2”, e só pode ser executado durante a carga do sistema (e não com o sistema já executando). A idéia é ressaltar a impossibilidade de alterar as partições com o sistema em funcionamento.</p>
<p>Para executar o “fdisk”, insira o CDROM ou o disquete de BOOT do TROPIX, e recarregue o sistema (conforme o capítulo 8). Quando surgir o “prompt” “boot&gt;” do “boot2”, tecle “-f”:</p>
<pre><code> boot&gt; -f</code></pre>
<p>Entrando no editor de tabelas de partições “fdisk”</p>
<pre><code> Tecle &quot;?&quot; para uma lista de comandos

 Disco &quot;hda&quot;: 6149.88 MB (12594960 blocos), geo = (784, 255, 63, L)

 IND. -DEV- A D -INÍCIO- --FINAL- -BLOCOs- TAM (MB) TIPO

 1  hda1   *         63  4209029  4208967  2055.16  0C DOS FAT32 (L)</code></pre>
<p>A geometria do disco (“geo”) é dada através do número de cilindros (784), número de cabeças (255) e o número de setores por trilha (63). A letra “L” ao final indica que para este disco, as extensões da INT 13 da BIOS estão ativas (em caso contrário, a letra indicada seria “G”).</p>
<p>Uma vez com o “prompt” do “fdisk”, teclando “?” obtemos uma lista dos comandos disponiveis:</p>
<pre><code> fdisk&gt; ?

 Editor de tabelas de partições

 comandos: 
 -: Imprime a tabela de partições 
 p: Idem, com áreas vagas 
 c:  Troca o dispositivo (disco) 
 n: Cria uma partição nova 
 d: Remove uma partição 
 m: Altera o tamanho de uma partição 
 a: Troca o estado (ativo/não ativo) da partição 
 l: Imprime os tipos das partições
 t: Troca o tipo da partição
 s: Imprime as áreas vagas do disco
 u: Liga/desliga o alinhamento (começa ligado)
 w: Reescreve (atualiza) a tabela de partições no disco
 q: Termina a execução do editor de partições

 Obs.: Para qualquer dado pedido, &quot;n&quot; cancela o comando</code></pre>
<p>Inicialmente vamos criar uma partição estendida para conter os 2 sistemas de arquivos (tradicionais) do TROPIX. Tecle “n”, e siga o seguinte diálogo (repare na opção do tipo da partição estendida):</p>
<pre><code> fdisk&gt; n

 Dê o tipo desejado: regular (r), estendida (e) ou lógica (l): e

 Número da partição = 2? (s):

 Dê o tipo de partição estendida: DOS (d) ou TROPIX (x): x

 Bloco inicial = 4209030? (s):

 Bloco final = 12402179 (4000.56 MB)? (s): n

 Dê o tamanho desejado (MB): 128

 Disco &quot;hda&quot;: 6149.88 MB (12594960 blocos), geo = (784, 255, 63, L)

 IND. -DEV- A D -INÍCIO- --FINAL- -BLOCOs- TAM (MB) TIPO

 1  hda1   *         63  4209029  4208967  2055.16  0C DOS FAT32 (L)
 2  hda2        4209030  4482134   273105   133.35  AE TROPIX Extended</code></pre>
<p>Neste ponto podemos (opcionalmente) usar o comando “u” para não alinhar as partições seguintes (veja abaixo). O exemplo continua supondo que NÃO demos o comando “u”.</p>
<p>Em seguida, vamos criar a partição lógica para o ROOT. Tecle “n”, e siga o seguinte diálogo:</p>
<pre><code> fdisk&gt; n

 Dê o tipo desejado: regular (r), estendida (e) ou lógica (l): l

 Partição estendida &quot;hda2&quot;:

 Bloco inicial = 4209093? (s):

 Bloco final = 4482134 (133.32 MB)? (s): n

 Dê o tamanho desejado (MB): 64

 Disco &quot;hda&quot;: 6149.88 MB (12594960 blocos), geo = (784, 255, 63, L)

 IND. -DEV- A D -INÍCIO- --FINAL- -BLOCOs- TAM (MB) TIPO

 1  hda1   *         63  4209029  4208967  2055.16  0C DOS FAT32 (L)
 2  hda2        4209030  4482134   273105   133.35  AE TROPIX Extended
 3  hda2a       4209093  4353614   144522    70.57  A9 TROPIX T1</code></pre>
<p>Em seguida, vamos criar a partição lógica para o HOME. Tecle “n”, e siga o seguinte diálogo:</p>
<pre><code> fdisk&gt; n

 Dê o tipo desejado: regular (r), estendida (e) ou lógica (l): l

 Partição estendida &quot;hda2&quot;:

 Bloco inicial = 4353678? (s):

 Bloco final = 4482134 (62.72 MB)? (s):

 Disco &quot;hda&quot;: 6149.88 MB (12594960 blocos), geo = (784, 255, 63, L)

 IND. -DEV- A D -INÍCIO- --FINAL- -BLOCOs- TAM (MB) TIPO

 1  hda1   *         63  4209029  4208967  2055.16  0C DOS FAT32 (L)
 2  hda2        4209030  4482134   273105   133.35  AE TROPIX Extended
 3  hda2a       4209093  4353614   144522    70.57  A9 TROPIX T1
 4  hda2b       4353678  4482134   128457    62.72  A9 TROPIX T1</code></pre>
<p>Finalmente, vamos ativar a partição ROOT, para possibilitar a carga do sistema (“boot”) através do gerenciador de carga (o “boot0”). Tecle “a”, e siga o seguinte diálogo:</p>
<pre><code> fdisk&gt; a

 Índice da partição: 3

 Disco &quot;hda&quot;: 6149.88 MB (12594960 blocos), geo = (784, 255, 63, L)

 IND. -DEV- A D -INÍCIO- --FINAL- -BLOCOs- TAM (MB) TIPO

 1  hda1   *         63  4209029  4208967  2055.16  0C DOS FAT32 (L)
 2  hda2        4209030  4482134   273105   133.35  AE TROPIX Extended
 3  hda2a  *    4209093  4353614   144522    70.57  A9 TROPIX T1
 4  hda2b       4353678  4482134   128457    62.72  A9 TROPIX T1</code></pre>
<p>Uma vez conferida a tabela de partições, podemos escrevê-la no disco rígido através dos seguintes comandos:</p>
<pre><code> fdisk&gt; w

 Reescreve a tabela de partições? (n): s

 fdisk&gt; q

 Saindo do editor de tabelas de partições

 boot&gt;</code></pre>
<p>O único comando “perigoso” é o “w” (com a respectiva confirmação), pois todos os outros comandos apenas modificam a tabela de partições na memória principal, sem atualizá-la no disco rígido.</p>
<p>Portanto, você pode “brincar” à vontade, criando e removendo partições, até que esteja satisfeito com a sua configuração, dando então o “w” final.</p>
<p>Repare que os tamanhos dados (128 MB, 64 MB e 64 MB) não foram obedecidos exatamente; na realidade eles foram arredondados para múltiplos do tamanho do cilindro do disco. Como este disco tem um cilindro razoavelmente grande (255 * 63 = 16065 blocos ~= 7.8 MB), as diferenças são significativas. Um modo de evitar isto, é usar o comando “u”, que impede o arredondamento.</p>
<h1 id="capítulo-14">Capítulo 14</h1>
<h2 id="reduzindo-o-tamanho-de-uma-partição-ms-doswindows">REDUZINDO O TAMANHO DE UMA PARTIÇÃO MS-DOS/Windows</h2>
<p>Um dos casos mais freqüentes é o de PCs que possuem apenas um disco rígido totalmente ocupado com apenas uma partição MS-DOS/Windows, correspondente a “C:”.</p>
<p>Neste caso, à primeira vista, existem apenas 2 possibilidades para obter espaço para partições TROPIX: instalar um novo disco rígido, ou então salvar os seus arquivos MS-DOS/Windows e reinstalar o MS-DOS/Windows em uma partição de tamanho menor.</p>
<p>Uma terceira possibilidade consiste na redução da partição MS-DOS/Windows em sua própria localização (isto é, sem destruir o seu conteúdo). Isto pode ser realizado pelo comando “chsize” do utilitário “dosmp”. Também é possível usar o programa “fips” do LINUX, ou ainda o programa PARTITION MAGIC, da firma PowerQuest, se você por acaso o possui.</p>
<p>Antes do uso do comando “chsize”, para a redução do tamanho da partição MS-DOS/Windows, é essencial verificar a sua integridade e desfragmentá-la. A verificação da integridade pode ser feita pelos utilitários CHKDSK ou SCANDISK (do MS-DOS/Windows) ou ainda NDD (Norton Disk Doctor) dos “NORTON Utilities”. A defragmentação pode ser feita pelo utilitário DEFRAG (do MS-DOS/Windows), ou o SPEED DISK dos “NORTON Utilities”.</p>
<p>Lembre-se de que os programas de desfragmentação possivelmente NÃO movem o arquivo de “swap” do MS-DOS/Windows. Você deve removê-lo (usando o “Control Panel”) e posteriormente reinstalá-lo.</p>
<p>Se você usa IMAGE ou MIRROR, o último setor da partição contém um arquivo “oculto” de nome “\image`{=tex}.idx” ou “\mirorsav.fil”. Você deve remover este arquivo (usando “attrib” e “del”). Ele será recriado na próxima vez que você executar IMAGE ou MIRROR (assim esperamos, não testamos).</p>
<p>Outra fonte de problemas são arquivos de nome “<em>\desktop.</em>”, os quais o Windows não move: eles devem ser salvos e posteriormente restaurados.</p>
<p>Se você usa um sistema de arquivos comprimido com “Stacker”, “SuperStor”, “Doublespace”, …, possivelmente (?) “chsize” não irá funcionar. Não testamos “chsize” nestes casos (nem sabemos se PARTITION MAGIC os suporta).</p>
<p>Após a desfragmentação, insira o CDROM ou o disquete de BOOT do TROPIX e carregue o sistema (conforme o capítulo 8), entrando no modo multiusuário.</p>
<p>Retire o disquete de BOOT (se você está instalando através de disquete) e insira um disquete (por exemplo MS-DOS/Windows), e monte-o através de</p>
<pre><code> mount /dev/fd0 /fd0</code></pre>
<p>Este disquete destina-se para armazenar o superbloco original do sistema de arquivos MS-DOS/Windows para o caso de eventuais problemas.</p>
<p>Em seguida, tecle</p>
<pre><code> cd /fd0
 dosmp /dev/hda1</code></pre>
<p>onde “/dev/hda1” deve ser substituído pela partição correspondente ao sistema de arquivos MS-DOS/Windows em questão (em geral será o próprio “/dev/hda1”, que corresponde à unidade “C:”).</p>
<p>Teclando</p>
<pre><code> chsize</code></pre>
<p>obtemos (por exemplo):</p>
<pre><code> Tamanho atual da partição DOS            = 511.84 MB
 Tamanho atual do sistema de arquivos DOS = 511.84 MB
 Espaço livre disponível ao final         = 427.26 MB</code></pre>
<p>Verifique se o espaço livre disponível é suficiente para a nova partição desejada. No nosso exemplo, temos espaço suficiente para o caso típico de 128 MB (427.26 &gt; 128). Lembre-se naturalmente de deixar algum espaço para futuros (novos) arquivos DOS.</p>
<p>Para liberarmos 128 MB (que serão usados para a nova partição a ser criada para o TROPIX), devemos teclar</p>
<pre><code> rw
 chsize -s 128</code></pre>
<p>e obteremos (por exemplo):</p>
<pre><code> Tamanho atual da partição DOS            = 511.84 MB
 Tamanho atual do sistema de arquivos DOS = 511.84 MB
 Espaço livre disponível ao final         = 427.26 MB

 Tamanho novo da partição DOS             = 382.03 MB
                                            (782401 blocos)
 Tamanho novo do sistema de arquivos DOS  = 382.03 MB
 Tamanho da nova partição (a ser criada)  = 129.81 MB
                                            (265856 blocos)

 Continua? (n):</code></pre>
<p>Repare que os valores não são exatamentos os pedidos, em virtude de arredondamentos para cilindros inteiros.</p>
<p>Se concordarmos com os valores dados, devemos teclar “s” e anotar os valores dados: tamanho novo da partição DOS = 382.03 MB, 782401 blocos e tamanho da nova partição (a ser criada) = 129.81 MB, 265856 blocos.</p>
<p>O comando “dosmp” guarda o superbloco original do sistema de arquivos DOS no arquivo “dos_sb” do diretório corrente (no caso, no disquete montado), para o caso de eventuais problemas.</p>
<p>Em seguida, saímos do “dosmp” (com “q”) e do TROPIX (com “reboot”).</p>
<p>Entre novamente no sistema MS-DOS/Windows, e assegure-se de que ele continua funcionando corretamente. Verifique a integridade do sistema de arquivos (normalmente “C:”) e se todos os seus arquivos continuam acessíveis.</p>
<p>Se surgir ALGUM PROBLEMA com o sistema MS-DOS/Windows, restaure o sistema de arquivos original, recarregando o TROPIX e executando os comandos</p>
<pre><code> mount /dev/fd0 /fd0
 cd /fd0
 dd if=dos_sb of=/dev/hda1</code></pre>
<p>com o disquete no qual foi armazenado o superbloco original do sistema DOS. Neste caso, comunique-nos (através do endereço eletrônico do capítulo 1) a falha do “chsize”.</p>
<p>Uma vez constatado que o sistema MS-DOS/Windows está funcionando corretamente, utilize o utilitário “fdisk” do TROPIX (conforme o capítulo 13), para alterar a tabela de partições.</p>
<p>Inicialmente, altere o tamanho da partição DOS (utilizando o comando “m”). O novo tamanho (valor em blocos) deve corresponder exatamente ao tamanho anotado acima (no caso, 382.03 MB, 782401 blocos).</p>
<p>Finalmente, crie a partição TROPIX no espaço liberado, conforme o exemplo do capítulo 13 (no caso, 129.81 MB, 265856 blocos).</p>
<p>Pronto! Já é hora de instalar o TROPIX nas novas partições, conforme o capítulo 15.</p>
<h1 id="capítulo-15">Capítulo 15</h1>
<h2 id="instalação-do-tropix-em-partições-próprias">INSTALAÇÃO DO TROPIX EM PARTIÇÕES PRÓPRIAS</h2>
<p>Este é o melhor modo, pois oferece o melhor desempenho e possibilita a instalação do “boot0”, um gerenciador de “boot”. Este gerenciador permite a escolha do sistema operacional a carregar (de modo que TROPIX possa ser carregado sem a utilização de CDROM ou disquete). Ele já foi testado com LINUX, FreeBSD e DOS/WinXP/Win2000/WinNT/Win98/Win95/Win3.x.</p>
<p>Se você está lendo este capítulo, supomos que já possua espaço em disco para partições TROPIX e já saiba como utilizar o editor de partições “fdisk”.</p>
<p>A idéia consiste em criar duas ou mais partições para o TROPIX. O mínimo é a criação de uma partição ROOT. Recomendamos, no entanto, criar pelo menos mais uma, HOME, para conter os arquivos particulares dos usuários.</p>
<p>Se você tiver 128 MB disponíveis, sugerimos 64 MB para ROOT e 64 MB para HOME; estes tamanhos serão suficientes inclusive para a interface gráfica X-Window. Caso tenha mais espaço disponível, pode aumentar os tamanhos das partições, ou até criar partições adicionais.</p>
<p>As etapas da instalação são as seguintes:</p>
<ol type="1">
<li><p>Crie as partições para o TROPIX através do editor de partições “fdisk” (veja o capítulo 13). NÃO esqueça de “ativar” a partição ROOT. NÃO é necessário que a partição ROOT (na qual será dado o “boot”) fique no primeiro disco.</p>
<p>Sugerimos criar uma partição estendida do tipo TROPIX para conter as diversas partições necessárias/desejadas; isto no entanto não é necessário: se for mais conveniente para o seu caso, as partições TROPIX podem também ser do tipo “regular” (“primária”), ou então partições lógicas dentro de uma partição estendida do tipo DOS. Se você tiver mais de um disco, é interessante distribuir as várias partições pelos vários discos.</p></li>
<li><p>Insira o CDROM ou disquete de BOOT do TROPIX e carregue o sistema (conforme o capítulo 8). Entre no modo multiusuário.</p></li>
<li><p>Vá para o diretório “/usr/etc/install” (use o comando “cd /usr/etc/install”). Inicie a instalação, através do comando “install”. Esta etapa gera sistemas de arquivos TROPIX nas partições escolhidas e copia os arquivos fundamentais do TROPIX para o disco rígido. Siga as instruções.</p>
<p>Se você deseja conservar uma versão antiga do sistema de arquivos HOME, responda afirmativamente a pergunta:</p>
<p>“Deseja conservar a versão antiga de HOME?”, e durante a cópia dos arquivos não permita a reescrita dos arquivos “.profile”.</p></li>
</ol>
<p>Parabéns! O TROPIX já está instalado e operacional em seu disco rígido.</p>
<p>Se você NÃO instalou o gerenciador de “boot”: para executar o TROPIX, recarregue o sistema com o CDROM ou disquete BOOT inserido, e no “prompt”</p>
<pre><code> boot&gt;</code></pre>
<p>tecle <enter>. Se o sistema for recarregado sem o CDROM nem disquete será carregado o sistema operacional “normal” (por exemplo Windows 95/98).</p>
<p>Se você INSTALOU o gerenciador: após a recarga do sistema o gerenciador imprime uma lista de partições “ativas” dos seus diversos discos rígidos, e espera você teclar o índice da partição desejada. A partição “default” pode ser modificada através do comando “edboot”.</p>
<p>Para sair do sistema TROPIX, use “shutdown”.</p>
<p>Se o gerenciador de “boot” NÃO funcionar, recarregue o TROPIX através do CDROM ou disquete BOOT (entrando no modo multiusuário) e restaure o gerenciador original, executando o comando do tipo</p>
<pre><code>         cat /etc/boot/mbr &gt;/dev/hda</code></pre>
<p>e comunique-nos (através do endereço eletrônico do capítulo 1) a falha do “boot0”.</p>
<p>Para facilitar a instalação futura de uma nova versão do TROPIX, recomendamos colocar seus arquivos particulares apenas no seu diretório “home” (nome de arquivos começando por “/home/…”).</p>
<h1 id="capítulo-16">Capítulo 16</h1>
<h2 id="configuração-dos-controladores-usb">CONFIGURAÇÃO DOS CONTROLADORES USB</h2>
<p>O TROPIX (na versão atual) suporta controladores USB dos padrões UHCI, OHCI e EHCI.</p>
<p>Há previsão de até 8 controladores (“usb0” a “usb7”); o sistema vem configurado com os controladores “usb0” a “usb3” habilitados e os demais desabilitados.</p>
<p>Isto pode ser alterado (somente para esta execução do sistema) através da modificação de parâmetros durante a carga do sistema; responda afirmativamente à pergunta</p>
<pre><code>    Deseja modificar parâmetros? (n):</code></pre>
<p>tal como mencionado no capítulo 8, e altere os valores de “usb0” a “usb7” para 0 ou 1.</p>
<p>Para a habilitação/desabilitação dos controladores (de modo permamente) use o comando “edscb” (Use “man scb” e “man edscb”).</p>
<p>Para verificar se o controlador USB está sendo reconhecido corretamente, acompanhe as mensagens durante a carga do sistema (ou então use o comando “dmesg” posteriormente).</p>
<h1 id="capítulo-17">Capítulo 17</h1>
<h2 id="e-agora">E AGORA …?</h2>
<p>Uma vez com o sistema implantado e em funcionamento, temos todos os manuais do TROPIX (em português) à disposição através do utilitário “man”. Além disto, todos os comandos fornecem um pequeno resumo de sua utilização através da opção “-H” (por exemplo “passwd -H”).</p>
<p>Para consultar o manual do utilitário “passwd” (por exemplo), tecle “man passwd”. Para avançar/retroceder pelas várias páginas dos manuais, temos os comandos &lt;^D&gt;, &lt;^U&gt;. Para encerrar a execução de “man”, use “q”. Experimente “man man”.</p>
<p>Recomendamos inicialmente a modificação da senha da conta “root” e a criação de contas regulares (isto é, NÃO superusuários). Para a modificação de senhas, utilize o comando “passwd”; para a criação/gerência de contas, use o comando “edusr”.</p>
<p>Também uma tarefa importante é a atualização do arquivo “/etc/fstab”, que contém informações dos sistemas de arquivos a montar. Leia o manual de “fstab” (fmt), “getmntent” (libc) e “mount” (cmd). Em particular, se você não tiver a partição HOME, remova a linha correspondente de “/etc/fstab”.</p>
<p>De vez em quando (digamos, uma vez por semana) é interessante verificar a integridade dos sistemas de arquivos. Para tanto, após a carga do sistema (ainda em modo “monousuário”), utilize o comando “fsck”. Repare que o arquivo “/etc/fstab” também controla os sistemas de arquivos examinados por “fsck” (convém colocar o “/dev/root” como o último da lista). Para obter uma lista de todas as partições presentes nos diversos discos do seu computador, use “prdisktb”.</p>
<p>Através do comando “edscb” você pode alterar o nome do computador (“nodename”) e acertar as portas/IRQs dos seus dispositivos (portas seriais, paralelas, “ethernet”, …). Use “man scb” e “man edscb”.</p>
<p>O TROPIX é distribuído com o DMA dos controladores IDE desligados, pois com certos controladores podem surgir problemas. Experimente ligá-lo através de “dmaenable=1”, inicialmente durante o “boot” para testar, e se funcionar adequadamente, no arquivo “/tropix” através do utilitário “edscb”. Com isto, você aumentará a performance dos seus discos rígidos IDE.</p>
<p>Leia o capítulo 26, onde é dada uma lista dos principais comandos do TROPIX.</p>
<p>Aprenda a usar o “histórico” do “sh”. Ele permite reexecutar comandos, inclusive com modificações (cada linha do histórico pode ser editada com os mesmos comandos do “vi”, antes de ser reexecutada).</p>
<p>Esta versão do TROPIX já possui o utilitário “sbwave” para tocar músicas PCM através de placas “Sound Blaster” ISA, veja o manual.</p>
<p>Durante a instalação, a INTERNET já é configurada para funcionar no modo interno (“loopback”), o que é necessário pela Interface Gráfica X-Window. Para configurar a INTERNET para o uso com outros dispositivos, use “man internet”.</p>
<p>Para a montagem de sistemas de arquivos remotos através do Sistema de Arquivos NFS (Network File System), use “man nfs”.</p>
<p>Leia o capítulo 18: ele menciona características não convencionais do TROPIX, as quais incluímos no sistema por considerá-las úteis.</p>
<p>Para instalar a Interface Gráfica X-Window, consulte os capítulos 19 a 22.</p>
<p>Para obter/compilar o código fonte do TROPIX, consulte os capítulos 23 e 24.</p>
<p>Naturalmente, este capítulo dá apenas o resumo de uma direção geral a tomar. O ideal é consultar um livro de introdução ao UNIX.</p>
<p>Esperamos que o TROPIX lhe seja útil, tanto no aprendizado de sistemas de filosofia UNIX, como na utilização de mais um sistema operacional. Em caso de dúvidas ou relatos de erros, utilize o endereço eletrônico do capítulo 1.</p>
<h1 id="capítulo-18">Capítulo 18</h1>
<h2 id="características-e-utilitários-originais-do-tropix">CARACTERÍSTICAS E UTILITÁRIOS ORIGINAIS DO TROPIX</h2>
<p>Embora o TROPIX seja um sistema de filosofia UNIX, há algumas características originais que não são encontradas em outros sistemas deste tipo. A seguir são dadas algumas destas originalidades:</p>
<ol type="1">
<li><p>Na maioria dos sistemas UNIX, quando listamos um arquivo de várias páginas no vídeo, ele “rola” fora da tela antes que possamos le-lo. Temos então de usar o comando “more” na forma</p>
<pre><code>      cat texto.txt | more</code></pre>
<p>ou então,</p>
<pre><code>      more texto.txt</code></pre>
<p>Isto é o caso, também, se usamos o comando “ls -l” com diretórios contendo muitos arquivos.</p>
<p>No TROPIX, isto não é necessário; a saída do vídeo é pausada quando ela completa o número de linhas visíveis. Para continuar a saída no vídeo, basta teclar &lt;^Q&gt;.</p>
<p>Isto pode ser alterado através do comando “stty” (veja o respectivo manual).</p></li>
<li><p>O utilitário “show”: permite visualizar um arquivo de texto de forma conveniente no vídeo, podendo avançar/retroceder sobre o texto com comandos semelhantes ao do editor de textos “vi”. É especialmente útil para examinar a saída de um programa, usando um “pipe” (veja o manual).</p></li>
<li><p>O comando “gar”: este utilitário é uma extensão do “tar”, padrão do mundo UNIX. O “gar”, além de criar/extrair coleções do formato “tar”, extrair coleções do formato “cpio”, ele cria/extrai/compara/adiciona coleções do formato próprio (“gar”) com/sem compactação. Você certamente já utilizou o “gar” ao instalar o TROPIX (veja o manual).</p></li>
<li><p>Os utilitários “cmptree/cptree”; permitem copiar/comparar/atualizar árvores do sistema de arquivos locais ao próprio computadores (veja o manual).</p></li>
<li><p>A família de utilitários “tcmpto”: permite copiar/comparar/atualizar árvores do sistema de arquivos de/entre o computador local e um computador remoto, através de protocolo próprio TCP/IP (veja o manual).</p></li>
</ol>
<h1 id="capítulo-19">Capítulo 19</h1>
<h2 id="introdução-à-interface-gráfica-x-window">INTRODUÇÃO À INTERFACE GRÁFICA X-WINDOW</h2>
<p>O sistema X-Window para o TROPIX é uma interface gráfica baseada na versão 4.7.0 distribuída pelo Consórcio XFree86.</p>
<p>A presente versão inclui servidores específicos para algumas das placas gráficas mais usuais. Além disto, são distribuídos os clientes indispensáveis para o funcionamento mínimo do sistema.</p>
<p>Apesar de os monitores modernos possuírem circuitos de proteção contra o uso com freqüências horizontal e/ou vertical indevidas, sempre existe teoricamente a possibilidade de danificar o seu monitor.</p>
<p>NÓS NÃO NOS RESPONSABILIZAMOS POR ESTES POSSÍVEIS DANOS AO SEU MONITOR. VOCÊ ESTÁ INSTALANDO/UTILIZANDO A INTERFACE GRÁFICA DO TROPIX SOB SUA PRÓPRIA RESPONSABILIDADE E RISCO!</p>
<h1 id="capítulo-20">Capítulo 20</h1>
<h2 id="criação-e-instalação-dos-disquetesarquivos-da-interface-gráfica">CRIAÇÃO E INSTALAÇÃO DOS DISQUETES/ARQUIVOS DA INTERFACE GRÁFICA</h2>
<p>Este capítulo contém informações apenas para a instalação através de disquetes. Se você está instalando através de um CDROM, pode pulá-lo.</p>
<p>A distribuição da Interface Gráfica X-Window é feita através da coleção “xwin.tgz”: obtenha-a na página do TROPIX (“http://tropix.nce.ufrj.br”).</p>
<p>Uma vez tendo obtida esta coleção, é necessário preparar os 2 arquivos ou criar os 2 disquetes de 3½". Ela contém os seguintes arquivos:</p>
<pre><code>            fdimage.exe
            xwin1.dsk
            xwin2.dsk</code></pre>
<p>O arquivo “fdimage.exe” é um utilitário de cópia para os Windows (você provavelmente já o tem, obtido durante a instalação do TROPIX básico), e os arquivos restantes são os conteúdos dos 2 disquetes.</p>
<p>Assim como no caso do TROPIX básico, se você possui uma partição DOS/Windows FAT16/32 ou NTFS em seu computador, a criação dos disquetes XWIN1 e XWIN2 pode ser dispensada. Siga o roteiro do capítulo 9 (substituindo “gar1” por “xwin1” e “xwin2”).</p>
<p>Uma vez com os disquetes ou arquivos preparados, entre no sistema TROPIX (como superusuário), vá para o diretório “/usr/etc/install”, e execute o comando</p>
<pre><code>            install.xwin</code></pre>
<p>e siga as suas instruções. O sistema necessita de cerca de 10 MB no disco.</p>
<h1 id="capítulo-21">Capítulo 21</h1>
<h2 id="configuração-da-interface-gráfica">CONFIGURAÇÃO DA INTERFACE GRÁFICA</h2>
<p>Uma vez instalados todos os arquivos da Interface Gráfica X-Window (se você está instalando através do CDROM isto é automático, para o caso de disquetes veja o capítulo anterior), vamos dar a seguir o método passo a passo para a configuração do sistema. Isto deve ser feito como superusuário.</p>
<ol type="1">
<li><p>Configuração da “internet”: Ela deverá está ativa, pelo menos para acessos internos (“loopback”); isto normalmente, a instalação do TROPIX já realiza. Para maiores detalhes, veja o manual “internet” (através do comando “man”).</p></li>
<li><p>Especificação do “mouse”: O sistema vem configurado para o “mouse” PS/2.</p>
<p>Para outros tipos de “mouse, o arquivo”/usr/xwin/conf/xconfig" deverá ser editado. Se o seu “mouse” for serial (COM1, COM2) ou USB, mova os dois caracteres “#” das linhas do seu tipo de “mouse” para as duas linhas do “mouse” PS/2.</p>
<p>Use o utilitário “dmesg” para verificar se, durante a carga do sistema, o seu “mouse” está sendo reconhecido.</p></li>
<li><p>Execução do servidor no modo de 16 cores (4 bits). Inicialmente o arquivo de configuração “/usr/xwin/conf/xconfig” está preparado para executar o servidor no modo gráfico do padrão VGA, de 16 cores e resolução de 640x480 e 800x600. Este modo deve funcionar com qualquer placa gráfica, e será sua (única) opção caso a sua placa não tenha sucesso nas tentativas abaixo.</p>
<p>Para tanto, basta teclar o comando “startx” (sem ter alterado o arquivo de configuração). O sistema iniciará com o fundo padrão do TROPIX, duas janelas “xterm”, um relógio e um selecionador de “desktops”. Em cada janela “xterm” é executado o interpretador de comandos padrão “sh”.</p>
<p>Para voltar ao modo texto, a maneira mais simples é teclar simultaneamente <ctl-alt-bs>.</p>
<p>Este é o modo mais básico de funcionamento do sistema X-Window; se ele não funcionar envie-nos os arquivos “/var/log/xwin/xserver.log” e “/var/log/xwin/xclients.log” para o endereço eletrônico do capítulo 1.</p></li>
<li><p>Determinação da placa gráfica: Uma vez funcionando no modo de 16 cores, podemos verificar se existe a possibilidade de utilizar um servidor específico para a sua placa gráfica. Isto proporcionará a possibilidade de usar uma gama maior de cores, e outras<br />
resoluções (800x600, 1024x768, 1280x1024, …).</p>
<p>Dependendo da sua placa gráfica, podemos editar o arquivo de configuração “/usr/xwin/conf/xconfig”. Se for uma placa ATI, coloque em comentário as linhas:</p>
<pre><code>        Driver          &quot;svga&quot;
        Device          &quot;Generic VGA&quot;</code></pre>
<p>colocando um “#” no início da linha, e tire o comentário das linhas:</p>
<pre><code>        Driver          &quot;accel&quot;
        Device          &quot;ati&quot;</code></pre>
<p>Além disto, altere o número de bits por cor comentando a linha:</p>
<pre><code>        DefaultColorDepth       4</code></pre>
<p>e tirando o “#” de uma das linhas (experimente):</p>
<pre><code>        DefaultColorDepth       8
        DefaultColorDepth       16
        DefaultColorDepth       24</code></pre>
<p>Para cada tentativa, entre no modo gráfico teclando “startx”, e para voltar ao modo de texto, tecle simultaneamente <ctl-alt-bs>. Obtenha infomações de sucesso/insucesso no arquivo “/var/log/xwin/xserver.log”.</p>
<p>As instruções são semelhantes, se a sua placa for uma NVIDIA ou TRIDENT, usando-se</p>
<pre><code>        Device          &quot;nv&quot;</code></pre>
<p>ou Device “trident”</p></li>
<li><p>Se a sua placa gráfica não for uma das acima, ou as tentativas acima não tiveram sucesso, você poderá apenas (na presente versão) usar o modo de 16 cores (4 bits).</p></li>
<li><p>Para alterar de resolução, tecle &lt;ctl-alt-+&gt; ou <ctl-alt--> (“+” e “-” do teclado numérico).</p></li>
</ol>
<p>Uma vez funcionando, você poderá tentar alterar o número de cores e o tamanho do seu “desktop”. Em caso de não conseguir, envie-nos os dois arquivos do diretório “/var/log/xwin”, conforme acima.</p>
<h1 id="capítulo-22">Capítulo 22</h1>
<h2 id="utilização-básica-da-interface-gráfica">UTILIZAÇÃO BÁSICA DA INTERFACE GRÁFICA</h2>
<p>Uma vez com o sistema em funcionamento, teremos (com já foi citado acima), duas janelas “xterm”, um relógio e um selecionador de “desktops”.</p>
<p>A pequena janela “xterm” superior é a da “console”, e não deve ser usada normalmente, pois nela serão escritas as mensagens de erro do sistema operacional.</p>
<p>Para movimentar uma janela, clique e arraste o botão da esquerda do “mouse” na moldura da janela.</p>
<p>Para alterar o tamanho de uma janela, clique e arraste o botão da esquerda do “mouse” em um dos 4 cantos da janela (nem todas as janelas admitem isto).</p>
<p>Para promover uma janela (isto é, colocá-la na frente das demais), clique o botão da esquerda na moldura da janela. Para rebaixá-la (isto é, colocá-la atrás das demais), clique o botão da direita na moldura da janela. Se você tiver um “mouse” de 3 botões, pode também promover uma janela com o botão do meio.</p>
<p>O botão da esquerda, clicado fora de qualquer janela, apresenta um “menu” de utilitários, além da opção para sair do modo gráfico (retornando ao modo de texto). O botão da direita, clicado fora de qualquer janela, apresenta uma lista das janelas ativas.</p>
<p>Tudo o que foi descrito até agora refere-se ao “desktop” 0. Clicando em um outro selecionador de “desktop” (no canto inferior direito), você terá um novo espaço independente para a criação de janelas. Você dispõe (na presente configuração), de 6 “desktops”.</p>
<h1 id="capítulo-23">Capítulo 23</h1>
<h2 id="obtenção-e-instalação-do-código-fonte-do-tropix">OBTENÇÃO E INSTALAÇÃO DO CÓDIGO FONTE DO TROPIX</h2>
<p>O código fonte do TROPIX é distribuído através dos 3 arquivos “kernel.tgz” (o núcleo do sistema), “lib.tgz” (as bibliotecas) e “cmd.tgz” (os utilitários). Tratam-se de coleções TAR comprimidas através do utilitário “gzip”.</p>
<p>Uma vez obtida uma coleção "*.tgz" através de um navegador, devemos descomprimi-la. Isto pode ser feito de diversos modos:</p>
<ol type="1">
<li><p>Se você armazenou a coleção "*.tgz" em um sistema de arquivos DOS/Windows FAT16/32, e está com o TROPIX instalado, pode acessá-la diretamente através do TROPIX, montando a partição com um comando da forma</p>
<pre><code> mount /dev/hda1 /mnt</code></pre>
<p>Em seguida, descomprima-a com:</p>
<pre><code> cd /mnt/...                  (Diretório do TROPIX)
 gunzip *.tgz                 (Nome da coleção)
 gar -ixv &lt;*.tar              (Nome da coleção TAR obtida)
 rm *.tar                     (Remove a coleção TAR)</code></pre></li>
<li><p>Se a sua partição DOS/Windows for NTFS (como ela é somente de leitura), o procedimento acima deverá ser efetuado após a cópia do arquivo "*.tgz" para uma partição TROPIX.</p></li>
<li><p>Se você está usando um sistema UNIX, deverá usar os utilitários “gunzip” e “tar”. Verifique os detalhes no seu sistema UNIX.</p></li>
<li><p>Se você está apenas com Windows, pode descomprimir a coleção com o utilitário “Winzip” e ler cada um dos programas através dos utilitários “Notepad”, “Wordpad” ou “Word”, entre outros.</p></li>
</ol>
<h1 id="capítulo-24">Capítulo 24</h1>
<h2 id="compilação-do-núcleo-bibliotecas-e-utilitários-do-tropix">COMPILAÇÃO DO NÚCLEO, BIBLIOTECAS E UTILITÁRIOS DO TROPIX</h2>
<p>Abaixo damos orientações para compilar os diversos componentes da distribuição do código fonte do TROPIX:</p>
<ol type="1">
<li><p>NÚCLEO DO SISTEMA: Uma vez com a árvore do núcleo instalada no TROPIX, você poderá compilar os diversos módulos que a integram: “boot/boot0”, “boot/boot1”, “boot/boot2” e “kernel”.</p>
<p>Em cada um dos diretórios há o “Makefile” para controlar a respectiva compilação.</p>
<p>Repare que no diretório “kernel” há o arquivo “scbfile.v” que contém parâmetros para configurar o seu núcleo em particular (veja “edscb” (cmd)).</p></li>
<li><p>BIBLIOTECAS: Na raiz da árvore há um “Makefile” para a compilação de todas as 4 bibliotecas. Se for desejado, pode ser compilada cada uma delas separadamente (indo para o diretório correspondente).</p></li>
<li><p>UTILITÁRIOS: Na raiz da árvore há um “Makefile” para a compilação de todos os utilitários. Se for desejado, pode ser compilado cada um deles separadamente (indo para o diretório correspondente).</p></li>
</ol>
<h1 id="capítulo-25">Capítulo 25</h1>
<h2 id="o-uso-do-editor-de-textos-vi">O USO DO EDITOR DE TEXTOS “VI”</h2>
<p>O utilitário “vi” é o editor de textos “padrão” dos sistemas operacionais de filosofia UNIX. Neste capítulo será dada uma pequena introdução ao seu uso, suficiente para realizar alterações nos arquivos de configuração (que eventualmente sejam necessárias), durante a instalação do TROPIX.</p>
<p>Maiores detalhes poderão ser vistos (posteriormente com o sistema em funcionamento regular), atráves de “man vi” ou ainda “man -g vi”.</p>
<p>Para editar um arquivo (por exemplo, de nome “abc”), teclamos “vi abc”, e o “vi” inicia o seu funcionamento mostrando a primeira página do arquivo “abc”, com o cursor no primeiro caractere da primeira linha.</p>
<p>Podemos então utilizar os seguintes comandos (repare que o cursor indica onde o comando será executado):</p>
<pre><code> &lt;sp&gt;       Avança (o cursor de) um caractere na linha.
 &lt;bs&gt;       Retrocede um caractere na linha.
 &quot;-&quot;        Retrocede uma linha no arquivo.
 &lt;enter&gt;    Avança uma linha no arquivo.
 &lt;^D&gt;       Avança meia página no arquivo.
 &lt;^U&gt;       Retrocede meia página no arquivo.
 &quot;1g&quot;       Retrocede para o início do arquivo.
 &quot;g&quot;        Avança para o final do arquivo.

 &quot;i&quot;        Insere texto antes do cursor (até um &lt;esc&gt;).
 &quot;a&quot;        Insere texto após o cursor (até um &lt;esc&gt;).
 &quot;o&quot;        Cria novas linhas e insere texto (até um &lt;esc&gt;).
 &quot;x&quot;        Remove o caractere indicado pelo cursor.
 &quot;dd&quot;       Remove uma linha.
 &quot;yyp&quot;      Copia uma linha.

 &quot;/...&quot;     Procura a cadeia &quot;...&quot;
 &quot;n&quot;        Procura a ocorrência seguinte da cadeia.
 &quot;N&quot;        Procura a ocorrência anterior da cadeia.

 &quot;.&quot;        Repete o último comando de edição.
 &quot;u&quot;        Desfaz o último comando de edição.

 &quot;:w&quot;       Atualiza o arquivo.
 &quot;:q&quot;       Sai do &quot;vi&quot; (somente se o arquivo está atualizado).
 &quot;:q!&quot;      Sai do &quot;vi&quot;, sem atualizar o arquivo.</code></pre>
<p>Repare que o arquivo sendo editado (“abc” no caso) só será atualizado quando for dado o comando “:w”. Se foi feita acidentalmente alguma modificação indesejada, podemos sair do “vi” com o comando “:q!”, conservando o arquivo em sua forma original.</p>
<h1 id="capítulo-26">Capítulo 26</h1>
<h2 id="uma-lista-dos-principais-comandos-dos-tropix">UMA LISTA DOS PRINCIPAIS COMANDOS DOS TROPIX</h2>
<p>Para a sua comodidade, damos abaixo uma lista alfabética dos principais comandos do TROPIX, juntamente com uma breve descrição de cada um. Para obter mais informações sobre um comando “x” (por exemplo), use “man x”.</p>
<pre><code> a2ps      - conversor de arquivos texto em PostScript
 as        - montador para INTEL-80386/486/PENTIUM
 bison     - gerador de analisadores sintáticos do GNU
 c         - escreve as linhas de um arquivo em várias colunas
 cat       - concatena e copia arquivos
 cc        - compilador para a linguagem &quot;C&quot;
 cdplay    - reproduz faixas de CDs
 cdtowave  - extrai faixas de CDs
 chgrp     - troca a identificação do grupo de arquivos
 chmod     - modifica a permissão de acesso de arquivos
 chown     - troca a identificação do dono (UID) de arquivos
 clear     - limpa a tela do terminal
 clr       - limpa a tela do terminal
 cls       - limpa a tela do terminal
 cmp       - compara pares de arquivos
 cmpobj    - compara pares de módulos objeto
 cmptree   - compara árvores
 comm      - seleciona ou rejeita linhas comuns a dois arquivos
             ordenados
 coremap   - imprime um mapa de alocação da memória
 cp        - copia arquivos
 cpfs      - copia sistemas de arquivos
 cptree    - copia uma árvore
 crypt     - codifica/decodifica arquivos
 data      - mostra/atualiza a data/hora corrente do sistema
 dc        - calculador de mesa com aritmética inteira
 dd        - copia e converte arquivos
 df        - informa sobre o espaço disponível de sistemas de
             arquivos
 diff      - comparador diferencial de arquivos
 dmesg     - imprime as mensagens iniciais de carga do núcleo
 dosmp     - monta/processa um sistema de arquivos no formato
             MS-DOS/Windows
 du        - informa sobre o uso de disco
 echo      - ecoa os arqumentos
 ed        - editor de textos orientado por linhas
 edboot    - gerencia &quot;boot0&quot; e &quot;boot2&quot;
 editscb   - edita/imprime o bloco de controle da INTERNET
 edobj     - editor de módulos objeto
 edscb     - imprime/edita o bloco de controle do núcleo do
             TROPIX
 edusr     - gerencia as contas/senhas
 eject     - ejeta o meio removível de um dispositivo
 ex        - editor visual de textos
 exportfs  - lista/atualiza a tabela &quot;exports&quot; do NFS
 fdc       - calculador de mesa com aritmética flutuante
 fdisk     - imprime e/ou modifica a tabela de partições
             de um disco
 fdformat  - formata disquetes
 file      - tenta identificar o conteúdo de um arquivo
 finger    - obtém informações sobre usuários remotos
 fsck      - verifica a consistência de sistemas de arquivos
 fsdefrag  - melhora a alocação dos blocos de um sistema de
             arquivos
 fsname    - consulta/atualiza nomes/volumes de sistemas de
             arquivos
 ftp       - programa de cópia remota de arquivos da INTERNET
 gar       - utilitário para a criação/atualização de coleções
             de arquivos
 grep      - busca de padrões em arquivos
 gunzip    - comprime ou expande arquivos
 gzip      - comprime ou expande arquivos
 help      - imprime resumos de utilização de comandos
 hpprint   - impressor para HP DeskJet (PCL)
 ifdef     - realiza préprocessamentos parciais
 includes  - descobre arquivos incluídos
 kill      - envia sinais a processos
 lasttime  - lista os nomes de arquivos modificados recentemente
 lc        - lista o conteúdo de diretórios
 ld        - link-editor de módulos objeto
 ldshlib   - carrega/descarrega uma biblioteca compartilhada
 linkoptim - substitui arquivos duplicados por elos físicos
 ln        - cria elos físicos ou simbólicos para arquivos
 ls        - lista características de arquivos e conteúdos de
             diretórios
 mail      - recebe ou envia cartas do correio eletrônico
 make      - gerenciador de manutenção de programas
 man       - mostra um manual na tela do terminal/vídeo/janela
 mkdev     - cria/atualiza os dispositivos de &quot;/dev&quot;
 mkdir     - cria diretórios
 mkfifo    - cria FIFOs
 mkfs      - gera um sistema de arquivos
 mklib     - cria/atualiza bibliotecas de módulos objeto
 mknod     - cria um arquivo especial
 mount     - monta um sistema de arquivos
 mv        - move (troca o nome de) arquivos
 mvtree    - move (troca o nome) de uma árvore/diretório
 nettime   - obtém a data/hora corrente de um nó remoto
 nice      - executa um comando com prioridade modificada
 nm        - imprime a tabela de símbolos de módulos objeto
 nohup     - executa um comando imune ao sinal SIGHUP
 pallwd    - imprime todos os diretórios correntes
 passwd    - altera a senha do usuário
 paste     - une linhas de vários arquivos
 ping      - teste de acesso a um nó remoto
 pop3      - acessa uma caixa postal remota através do
             protocolo POP3
 pr        - imprime arquivos
 prdisktb  - Imprime a tabela de discos/partições
 prsync    - imprime o estado da sincronização dos processos
 ps        - imprime informações sobre processos
 pwd       - imprime o diretório corrente
 reboot    - Encerra o uso do TROPIX, e recarrega o computador
 rlogin    - entra em sessão em um nó remoto
 rm        - Remove arquivos
 rmdir     - remove diretórios
 rmtree    - remove árvores
 sbvol     - controla o volume da placa de som SB-16
 sbwave    - Toca música PCM através da placa de som SB-16
 semafree  - libera o semáforo pelo qual o processo está
             esperando
 setmode   - atribui as proteções corretas aos arquivos do
             sistema
 sh        - interpretador de comandos
 show      - mostra um arquivo na tela do terminal
 shutdown  - reinicializa o computador após um certo tempo
 size      - imprime tamanhos e características de módulos
             objeto
 sleep     - suspende a execução por um intervalo de tempo
 sort      - ordena e/ou intercala arquivos
 sroff     - formatador de textos
 strip     - remove as tabelas de símbolos de módulos-objeto
 stty      - consulta/altera parâmetros de terminais/vídeos
 su        - muda de conta temporariamente
 subst     - busca/substitui cadeias em vários arquivos
 sync      - Atualiza os blocos do cache nos discos
 sysmap    - desenha um mapa de uso de alguns recursos do
             sistema (programa gráfico)
 tac       - descompila a descrição instalada de um terminal/
             vídeo
 tail      - obtém a parte final de um arquivo
 tcmpfrom  - comparação/atualização remota de árvores
             (caminhando árvores remotas)
 tcmpto    - comparação/atualização remota de árvores
             (caminhando árvores locais)
 tcpfrom   - cópia remota de árvores (caminhando árvores
             remotas)
 tcpto     - cópia remota de árvores (caminhando árvores
             locais)
 tee       - copia a entrada padrão para diversos arquivos e a
             saida padrão
 telnet    - comunica com um nó remoto utilizando o protocolo
             TELNET
 test      - testa propriedades de arquivos
 textmap   - imprime uma tabela de programas reentrantes em uso
 tic       - compila e instala a descrição de um terminal/vídeo
 touch     - Modifica os tempos de arquivos
 tpipe     - escreve arquivos remotos na saída padrão
 tr        - traduz caracteres
 tty       - imprime o nome do terminal/vídeo
 umount    - desmonta sistemas de arquivos
 uname     - imprime a identificação do sistema
 uniq      - indica linhas repetidas de um arquivo
 untext    - libera os recursos de programas reentrantes
 uptime    - fornece o tempo decorrido desde o último &quot;boot&quot;
 vi        - editor visual de textos
 walk      - caminha em árvores do sistema de arquivos
 wc        - contador de páginas, linhas, palavras e caracteres
 who       - informa quem está no sistema
 write     - escreve mensagens para um outro usuário
 xcoremap  - desenha um mapa de alocação da memória
             (programa gráfico)
 xclock    - relógio analógico (programa gráfico)
 xcpu      - desenha o gráfico de uso da CPU
 xd        - &quot;dump&quot; em hexadecimal e ISO
 xdefrag   - Melhora a alocação dos blocos de um sistema
             de arquivos T1
 xedit     - editor de textos simples para o sistema X-Window
 xfm       - gerenciador gráfico de arquivos
 xmandel   - desenha as imagens fractais de Mandelbrot
 xpop3     - acessa uma caixa postal remota através do
             protocolo POP3
 xpaint    - mostra uma imagem (gif, jpeg, bmp ou xpm) em uma
             janela (programa gráfico)
 xterm     - Emulador de terminal ANSI para X-Window
 ziptool   - ferramenta para dispositivos Iomega ZIP</code></pre>
